name: Notion PR Sync

on:
  pull_request:
    types: [opened, reopened, closed]

jobs:
  update-notion:
    runs-on: ubuntu-latest
    steps:
      - name: Update Notion page
        run: |
          curl -X PATCH "https://api.notion.com/v1/pages/$NOTION_PAGE_ID" \
          -H "Authorization: Bearer $NOTION_TOKEN" \
          -H "Content-Type: application/json" \
          -H "Notion-Version: 2022-06-28" \
          --data '{
            "properties": {
              "PR 상태": {
                "select": {"name": "'"$PR_STATE"'"}
              }
            }
          }'
        env:
          NOTION_TOKEN: ${{ secrets.NOTION_TOKEN }}
          NOTION_PAGE_ID: ${{ secrets.NOTION_PAGE_ID }}
          PR_STATE: ${{ github.event.pull_request.state }}
